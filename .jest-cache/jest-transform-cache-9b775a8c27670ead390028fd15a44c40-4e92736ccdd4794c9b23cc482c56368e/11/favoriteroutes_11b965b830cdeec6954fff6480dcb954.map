{"version":3,"names":["express","require","router","Router","protect","User","Apartment","get","req","res","user","findById","_id","populate","json","favorites","error","status","post","apartmentId","body","apartment","includes","push","save","message","delete","filter","id","toString","params","module","exports"],"sources":["favorite.routes.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst { protect } = require('../middleware/auth.middleware');\r\nconst User = require('../models/user.model');\r\nconst Apartment = require('../models/apartment.model');\r\n\r\n// GET /api/favorites - Get user's favorite apartments\r\nrouter.get('/', protect, async (req, res) => {\r\n  try {\r\n    const user = await User.findById(req.user._id).populate('favorites');\r\n    res.json({ favorites: user.favorites });\r\n  } catch (error) {\r\n    res.status(500).json({ error: 'Error fetching favorites' });\r\n  }\r\n});\r\n\r\n// POST /api/favorites - Add apartment to favorites\r\nrouter.post('/', protect, async (req, res) => {\r\n  try {\r\n    const { apartmentId } = req.body;\r\n\r\n    // Check if apartment exists\r\n    const apartment = await Apartment.findById(apartmentId);\r\n    if (!apartment) {\r\n      return res.status(404).json({ error: 'Apartment not found' });\r\n    }\r\n\r\n    // Add to favorites if not already there\r\n    const user = await User.findById(req.user._id);\r\n    if (!user.favorites.includes(apartmentId)) {\r\n      user.favorites.push(apartmentId);\r\n      await user.save();\r\n    }\r\n\r\n    res.json({ message: 'Added to favorites' });\r\n  } catch (error) {\r\n    res.status(500).json({ error: 'Error adding to favorites' });\r\n  }\r\n});\r\n\r\n// DELETE /api/favorites/:id - Remove apartment from favorites\r\nrouter.delete('/:id', protect, async (req, res) => {\r\n  try {\r\n    const user = await User.findById(req.user._id);\r\n    user.favorites = user.favorites.filter((id) => id.toString() !== req.params.id);\r\n    await user.save();\r\n    res.json({ message: 'Removed from favorites' });\r\n  } catch (error) {\r\n    res.status(500).json({ error: 'Error removing from favorites' });\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n"],"mappings":"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","ignoreList":[]}