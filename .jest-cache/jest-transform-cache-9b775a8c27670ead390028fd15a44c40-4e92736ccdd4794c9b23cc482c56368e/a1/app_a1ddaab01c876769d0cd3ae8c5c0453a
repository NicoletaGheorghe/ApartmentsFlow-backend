bd104a7c9b1824a4e9c5d9a867f7508d
'use strict';

/**
 * Module dependencies.
 */
const express = require('express');
const mongoose = require('mongoose');
const cors = require('cors');
const helmet = require('helmet');
const morgan = require('morgan');
const swaggerUi = require('swagger-ui-express');
const swaggerSpecs = require('./config/swagger');
const rateLimit = require('express-rate-limit');
require('dotenv').config();
const app = module.exports = express();

// create an error with .status. we
// can then use the property in our
// custom error handler (Connect respects this prop as well)
function error(status, msg) {
  const err = new Error(msg);
  err.status = status;
  return err;
}

// Connect to MongoDB only if not in test environment
if (process.env.NODE_ENV !== 'test') {
  mongoose.connect(process.env.MONGODB_URI).then(() => {
    console.log('Connected to MongoDB');
  }).catch(err => {
    console.error('MongoDB connection error:', err);
    process.exit(1);
  });
}

// Middleware
app.use(helmet()); // Security headers
app.use(cors()); // Enable CORS
app.use(express.json()); // Parse JSON bodies
app.use(morgan('dev')); // Logging

// Rate limiting middleware
const apiLimiter = rateLimit({
  windowMs: 15 * 60 * 1000,
  // 15 minutes
  max: 100,
  // Limit each IP to 100 requests per windowMs
  message: {
    error: 'Too many requests, please try again later.'
  },
  standardHeaders: true,
  // Return rate limit info in the `RateLimit-*` headers
  legacyHeaders: false // Disable the `X-RateLimit-*` headers
});

// Stricter rate limit for authentication endpoints
const authLimiter = rateLimit({
  windowMs: 60 * 60 * 1000,
  // 1 hour
  max: 5,
  // Limit each IP to 5 requests per windowMs
  message: {
    error: 'Too many authentication attempts, please try again later.'
  },
  standardHeaders: true,
  legacyHeaders: false
});

// Stricter rate limit for apartment creation/updates
const apartmentWriteLimiter = rateLimit({
  windowMs: 60 * 60 * 1000,
  // 1 hour
  max: 20,
  // Limit each IP to 20 requests per windowMs
  message: {
    error: 'Too many apartment modifications, please try again later.'
  },
  standardHeaders: true,
  legacyHeaders: false
});

// Apply rate limiting to routes
app.use('/api/auth/', authLimiter); // Stricter limits for auth routes
app.use('/api/apartments', apartmentWriteLimiter); // Stricter limits for apartment modifications
app.use('/api/', apiLimiter); // General rate limit for all other routes

// Swagger Documentation
app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(swaggerSpecs, {
  explorer: true,
  customCss: '.swagger-ui .topbar { display: none }',
  customSiteTitle: 'Apartment Flow API Documentation'
}));

// Import routes
const authRoutes = require('./routes/auth.routes');
const apartmentRoutes = require('./routes/apartment.routes');
const favoriteRoutes = require('./routes/favorite.routes');
const commuteRoutes = require('./routes/commute.routes');
const userRoutes = require('./routes/user.routes');

// Routes
app.use('/api/auth', authRoutes);
app.use('/api/apartments', apartmentRoutes);
app.use('/api/favorites', favoriteRoutes);
app.use('/api/commute', commuteRoutes);
app.use('/api/users', userRoutes);

// Error handling middleware
app.use(function (err, req, res, next) {
  // Log error for debugging
  console.error(err.stack);

  // Handle mongoose validation errors
  if (err.name === 'ValidationError') {
    return res.status(400).json({
      error: 'Validation Error',
      details: Object.values(err.errors).map(e => e.message)
    });
  }

  // Handle mongoose cast errors (invalid ObjectId)
  if (err.name === 'CastError') {
    return res.status(400).json({
      error: 'Invalid ID format',
      details: err.message
    });
  }

  // Handle JWT errors
  if (err.name === 'JsonWebTokenError') {
    return res.status(401).json({
      error: 'Invalid token',
      details: 'Please log in again'
    });
  }

  // Handle JWT expiration
  if (err.name === 'TokenExpiredError') {
    return res.status(401).json({
      error: 'Token expired',
      details: 'Please log in again'
    });
  }

  // Default error
  res.status(err.status || 500).json({
    error: err.message || 'Internal Server Error',
    details: process.env.NODE_ENV === 'development' ? err.stack : undefined
  });
});

// 404 handler (from Express.js web-service example)
app.use(function (req, res) {
  res.status(404);
  res.json({
    error: "Sorry, can't find that"
  });
});

// Start server
if (require.main === module) {
  const port = process.env.PORT || 3000;
  app.listen(port, () => {
    console.log(`Server is running on port ${port}`);
  });
}
module.exports = app;
// test
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsIm1vbmdvb3NlIiwiY29ycyIsImhlbG1ldCIsIm1vcmdhbiIsInN3YWdnZXJVaSIsInN3YWdnZXJTcGVjcyIsInJhdGVMaW1pdCIsImNvbmZpZyIsImFwcCIsIm1vZHVsZSIsImV4cG9ydHMiLCJlcnJvciIsInN0YXR1cyIsIm1zZyIsImVyciIsIkVycm9yIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwiY29ubmVjdCIsIk1PTkdPREJfVVJJIiwidGhlbiIsImNvbnNvbGUiLCJsb2ciLCJjYXRjaCIsImV4aXQiLCJ1c2UiLCJqc29uIiwiYXBpTGltaXRlciIsIndpbmRvd01zIiwibWF4IiwibWVzc2FnZSIsInN0YW5kYXJkSGVhZGVycyIsImxlZ2FjeUhlYWRlcnMiLCJhdXRoTGltaXRlciIsImFwYXJ0bWVudFdyaXRlTGltaXRlciIsInNlcnZlIiwic2V0dXAiLCJleHBsb3JlciIsImN1c3RvbUNzcyIsImN1c3RvbVNpdGVUaXRsZSIsImF1dGhSb3V0ZXMiLCJhcGFydG1lbnRSb3V0ZXMiLCJmYXZvcml0ZVJvdXRlcyIsImNvbW11dGVSb3V0ZXMiLCJ1c2VyUm91dGVzIiwicmVxIiwicmVzIiwibmV4dCIsInN0YWNrIiwibmFtZSIsImRldGFpbHMiLCJPYmplY3QiLCJ2YWx1ZXMiLCJlcnJvcnMiLCJtYXAiLCJlIiwidW5kZWZpbmVkIiwibWFpbiIsInBvcnQiLCJQT1JUIiwibGlzdGVuIl0sInNvdXJjZXMiOlsiYXBwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuICovXG5cbmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XG5jb25zdCBjb3JzID0gcmVxdWlyZSgnY29ycycpO1xuY29uc3QgaGVsbWV0ID0gcmVxdWlyZSgnaGVsbWV0Jyk7XG5jb25zdCBtb3JnYW4gPSByZXF1aXJlKCdtb3JnYW4nKTtcbmNvbnN0IHN3YWdnZXJVaSA9IHJlcXVpcmUoJ3N3YWdnZXItdWktZXhwcmVzcycpO1xuY29uc3Qgc3dhZ2dlclNwZWNzID0gcmVxdWlyZSgnLi9jb25maWcvc3dhZ2dlcicpO1xuY29uc3QgcmF0ZUxpbWl0ID0gcmVxdWlyZSgnZXhwcmVzcy1yYXRlLWxpbWl0Jyk7XG5yZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoKTtcblxuY29uc3QgYXBwID0gKG1vZHVsZS5leHBvcnRzID0gZXhwcmVzcygpKTtcblxuLy8gY3JlYXRlIGFuIGVycm9yIHdpdGggLnN0YXR1cy4gd2Vcbi8vIGNhbiB0aGVuIHVzZSB0aGUgcHJvcGVydHkgaW4gb3VyXG4vLyBjdXN0b20gZXJyb3IgaGFuZGxlciAoQ29ubmVjdCByZXNwZWN0cyB0aGlzIHByb3AgYXMgd2VsbClcbmZ1bmN0aW9uIGVycm9yKHN0YXR1cywgbXNnKSB7XG4gIGNvbnN0IGVyciA9IG5ldyBFcnJvcihtc2cpO1xuICBlcnIuc3RhdHVzID0gc3RhdHVzO1xuICByZXR1cm4gZXJyO1xufVxuXG4vLyBDb25uZWN0IHRvIE1vbmdvREIgb25seSBpZiBub3QgaW4gdGVzdCBlbnZpcm9ubWVudFxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAndGVzdCcpIHtcbiAgbW9uZ29vc2VcbiAgICAuY29ubmVjdChwcm9jZXNzLmVudi5NT05HT0RCX1VSSSlcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnQ29ubmVjdGVkIHRvIE1vbmdvREInKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKCdNb25nb0RCIGNvbm5lY3Rpb24gZXJyb3I6JywgZXJyKTtcbiAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9KTtcbn1cblxuLy8gTWlkZGxld2FyZVxuYXBwLnVzZShoZWxtZXQoKSk7IC8vIFNlY3VyaXR5IGhlYWRlcnNcbmFwcC51c2UoY29ycygpKTsgLy8gRW5hYmxlIENPUlNcbmFwcC51c2UoZXhwcmVzcy5qc29uKCkpOyAvLyBQYXJzZSBKU09OIGJvZGllc1xuYXBwLnVzZShtb3JnYW4oJ2RldicpKTsgLy8gTG9nZ2luZ1xuXG4vLyBSYXRlIGxpbWl0aW5nIG1pZGRsZXdhcmVcbmNvbnN0IGFwaUxpbWl0ZXIgPSByYXRlTGltaXQoe1xuICB3aW5kb3dNczogMTUgKiA2MCAqIDEwMDAsIC8vIDE1IG1pbnV0ZXNcbiAgbWF4OiAxMDAsIC8vIExpbWl0IGVhY2ggSVAgdG8gMTAwIHJlcXVlc3RzIHBlciB3aW5kb3dNc1xuICBtZXNzYWdlOiB7IGVycm9yOiAnVG9vIG1hbnkgcmVxdWVzdHMsIHBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyB9LFxuICBzdGFuZGFyZEhlYWRlcnM6IHRydWUsIC8vIFJldHVybiByYXRlIGxpbWl0IGluZm8gaW4gdGhlIGBSYXRlTGltaXQtKmAgaGVhZGVyc1xuICBsZWdhY3lIZWFkZXJzOiBmYWxzZSwgLy8gRGlzYWJsZSB0aGUgYFgtUmF0ZUxpbWl0LSpgIGhlYWRlcnNcbn0pO1xuXG4vLyBTdHJpY3RlciByYXRlIGxpbWl0IGZvciBhdXRoZW50aWNhdGlvbiBlbmRwb2ludHNcbmNvbnN0IGF1dGhMaW1pdGVyID0gcmF0ZUxpbWl0KHtcbiAgd2luZG93TXM6IDYwICogNjAgKiAxMDAwLCAvLyAxIGhvdXJcbiAgbWF4OiA1LCAvLyBMaW1pdCBlYWNoIElQIHRvIDUgcmVxdWVzdHMgcGVyIHdpbmRvd01zXG4gIG1lc3NhZ2U6IHsgZXJyb3I6ICdUb28gbWFueSBhdXRoZW50aWNhdGlvbiBhdHRlbXB0cywgcGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4nIH0sXG4gIHN0YW5kYXJkSGVhZGVyczogdHJ1ZSxcbiAgbGVnYWN5SGVhZGVyczogZmFsc2UsXG59KTtcblxuLy8gU3RyaWN0ZXIgcmF0ZSBsaW1pdCBmb3IgYXBhcnRtZW50IGNyZWF0aW9uL3VwZGF0ZXNcbmNvbnN0IGFwYXJ0bWVudFdyaXRlTGltaXRlciA9IHJhdGVMaW1pdCh7XG4gIHdpbmRvd01zOiA2MCAqIDYwICogMTAwMCwgLy8gMSBob3VyXG4gIG1heDogMjAsIC8vIExpbWl0IGVhY2ggSVAgdG8gMjAgcmVxdWVzdHMgcGVyIHdpbmRvd01zXG4gIG1lc3NhZ2U6IHsgZXJyb3I6ICdUb28gbWFueSBhcGFydG1lbnQgbW9kaWZpY2F0aW9ucywgcGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4nIH0sXG4gIHN0YW5kYXJkSGVhZGVyczogdHJ1ZSxcbiAgbGVnYWN5SGVhZGVyczogZmFsc2UsXG59KTtcblxuLy8gQXBwbHkgcmF0ZSBsaW1pdGluZyB0byByb3V0ZXNcbmFwcC51c2UoJy9hcGkvYXV0aC8nLCBhdXRoTGltaXRlcik7IC8vIFN0cmljdGVyIGxpbWl0cyBmb3IgYXV0aCByb3V0ZXNcbmFwcC51c2UoJy9hcGkvYXBhcnRtZW50cycsIGFwYXJ0bWVudFdyaXRlTGltaXRlcik7IC8vIFN0cmljdGVyIGxpbWl0cyBmb3IgYXBhcnRtZW50IG1vZGlmaWNhdGlvbnNcbmFwcC51c2UoJy9hcGkvJywgYXBpTGltaXRlcik7IC8vIEdlbmVyYWwgcmF0ZSBsaW1pdCBmb3IgYWxsIG90aGVyIHJvdXRlc1xuXG4vLyBTd2FnZ2VyIERvY3VtZW50YXRpb25cbmFwcC51c2UoXG4gICcvYXBpLWRvY3MnLFxuICBzd2FnZ2VyVWkuc2VydmUsXG4gIHN3YWdnZXJVaS5zZXR1cChzd2FnZ2VyU3BlY3MsIHtcbiAgICBleHBsb3JlcjogdHJ1ZSxcbiAgICBjdXN0b21Dc3M6ICcuc3dhZ2dlci11aSAudG9wYmFyIHsgZGlzcGxheTogbm9uZSB9JyxcbiAgICBjdXN0b21TaXRlVGl0bGU6ICdBcGFydG1lbnQgRmxvdyBBUEkgRG9jdW1lbnRhdGlvbicsXG4gIH0pXG4pO1xuXG4vLyBJbXBvcnQgcm91dGVzXG5jb25zdCBhdXRoUm91dGVzID0gcmVxdWlyZSgnLi9yb3V0ZXMvYXV0aC5yb3V0ZXMnKTtcbmNvbnN0IGFwYXJ0bWVudFJvdXRlcyA9IHJlcXVpcmUoJy4vcm91dGVzL2FwYXJ0bWVudC5yb3V0ZXMnKTtcbmNvbnN0IGZhdm9yaXRlUm91dGVzID0gcmVxdWlyZSgnLi9yb3V0ZXMvZmF2b3JpdGUucm91dGVzJyk7XG5jb25zdCBjb21tdXRlUm91dGVzID0gcmVxdWlyZSgnLi9yb3V0ZXMvY29tbXV0ZS5yb3V0ZXMnKTtcbmNvbnN0IHVzZXJSb3V0ZXMgPSByZXF1aXJlKCcuL3JvdXRlcy91c2VyLnJvdXRlcycpO1xuXG4vLyBSb3V0ZXNcbmFwcC51c2UoJy9hcGkvYXV0aCcsIGF1dGhSb3V0ZXMpO1xuYXBwLnVzZSgnL2FwaS9hcGFydG1lbnRzJywgYXBhcnRtZW50Um91dGVzKTtcbmFwcC51c2UoJy9hcGkvZmF2b3JpdGVzJywgZmF2b3JpdGVSb3V0ZXMpO1xuYXBwLnVzZSgnL2FwaS9jb21tdXRlJywgY29tbXV0ZVJvdXRlcyk7XG5hcHAudXNlKCcvYXBpL3VzZXJzJywgdXNlclJvdXRlcyk7XG5cbi8vIEVycm9yIGhhbmRsaW5nIG1pZGRsZXdhcmVcbmFwcC51c2UoZnVuY3Rpb24gKGVyciwgcmVxLCByZXMsIG5leHQpIHtcbiAgLy8gTG9nIGVycm9yIGZvciBkZWJ1Z2dpbmdcbiAgY29uc29sZS5lcnJvcihlcnIuc3RhY2spO1xuXG4gIC8vIEhhbmRsZSBtb25nb29zZSB2YWxpZGF0aW9uIGVycm9yc1xuICBpZiAoZXJyLm5hbWUgPT09ICdWYWxpZGF0aW9uRXJyb3InKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgIGVycm9yOiAnVmFsaWRhdGlvbiBFcnJvcicsXG4gICAgICBkZXRhaWxzOiBPYmplY3QudmFsdWVzKGVyci5lcnJvcnMpLm1hcCgoZSkgPT4gZS5tZXNzYWdlKSxcbiAgICB9KTtcbiAgfVxuXG4gIC8vIEhhbmRsZSBtb25nb29zZSBjYXN0IGVycm9ycyAoaW52YWxpZCBPYmplY3RJZClcbiAgaWYgKGVyci5uYW1lID09PSAnQ2FzdEVycm9yJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICBlcnJvcjogJ0ludmFsaWQgSUQgZm9ybWF0JyxcbiAgICAgIGRldGFpbHM6IGVyci5tZXNzYWdlLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gSGFuZGxlIEpXVCBlcnJvcnNcbiAgaWYgKGVyci5uYW1lID09PSAnSnNvbldlYlRva2VuRXJyb3InKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgIGVycm9yOiAnSW52YWxpZCB0b2tlbicsXG4gICAgICBkZXRhaWxzOiAnUGxlYXNlIGxvZyBpbiBhZ2FpbicsXG4gICAgfSk7XG4gIH1cblxuICAvLyBIYW5kbGUgSldUIGV4cGlyYXRpb25cbiAgaWYgKGVyci5uYW1lID09PSAnVG9rZW5FeHBpcmVkRXJyb3InKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgIGVycm9yOiAnVG9rZW4gZXhwaXJlZCcsXG4gICAgICBkZXRhaWxzOiAnUGxlYXNlIGxvZyBpbiBhZ2FpbicsXG4gICAgfSk7XG4gIH1cblxuICAvLyBEZWZhdWx0IGVycm9yXG4gIHJlcy5zdGF0dXMoZXJyLnN0YXR1cyB8fCA1MDApLmpzb24oe1xuICAgIGVycm9yOiBlcnIubWVzc2FnZSB8fCAnSW50ZXJuYWwgU2VydmVyIEVycm9yJyxcbiAgICBkZXRhaWxzOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyA/IGVyci5zdGFjayA6IHVuZGVmaW5lZCxcbiAgfSk7XG59KTtcblxuLy8gNDA0IGhhbmRsZXIgKGZyb20gRXhwcmVzcy5qcyB3ZWItc2VydmljZSBleGFtcGxlKVxuYXBwLnVzZShmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgcmVzLnN0YXR1cyg0MDQpO1xuICByZXMuanNvbih7IGVycm9yOiBcIlNvcnJ5LCBjYW4ndCBmaW5kIHRoYXRcIiB9KTtcbn0pO1xuXG4vLyBTdGFydCBzZXJ2ZXJcbmlmIChyZXF1aXJlLm1haW4gPT09IG1vZHVsZSkge1xuICBjb25zdCBwb3J0ID0gcHJvY2Vzcy5lbnYuUE9SVCB8fCAzMDAwO1xuICBhcHAubGlzdGVuKHBvcnQsICgpID0+IHtcbiAgICBjb25zb2xlLmxvZyhgU2VydmVyIGlzIHJ1bm5pbmcgb24gcG9ydCAke3BvcnR9YCk7XG4gIH0pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGFwcDtcbi8vIHRlc3RcbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFFWjtBQUNBO0FBQ0E7QUFFQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUMsUUFBUSxHQUFHRCxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ3BDLE1BQU1FLElBQUksR0FBR0YsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUM1QixNQUFNRyxNQUFNLEdBQUdILE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFDaEMsTUFBTUksTUFBTSxHQUFHSixPQUFPLENBQUMsUUFBUSxDQUFDO0FBQ2hDLE1BQU1LLFNBQVMsR0FBR0wsT0FBTyxDQUFDLG9CQUFvQixDQUFDO0FBQy9DLE1BQU1NLFlBQVksR0FBR04sT0FBTyxDQUFDLGtCQUFrQixDQUFDO0FBQ2hELE1BQU1PLFNBQVMsR0FBR1AsT0FBTyxDQUFDLG9CQUFvQixDQUFDO0FBQy9DQSxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUNRLE1BQU0sQ0FBQyxDQUFDO0FBRTFCLE1BQU1DLEdBQUcsR0FBSUMsTUFBTSxDQUFDQyxPQUFPLEdBQUdaLE9BQU8sQ0FBQyxDQUFFOztBQUV4QztBQUNBO0FBQ0E7QUFDQSxTQUFTYSxLQUFLQSxDQUFDQyxNQUFNLEVBQUVDLEdBQUcsRUFBRTtFQUMxQixNQUFNQyxHQUFHLEdBQUcsSUFBSUMsS0FBSyxDQUFDRixHQUFHLENBQUM7RUFDMUJDLEdBQUcsQ0FBQ0YsTUFBTSxHQUFHQSxNQUFNO0VBQ25CLE9BQU9FLEdBQUc7QUFDWjs7QUFFQTtBQUNBLElBQUlFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxRQUFRLEtBQUssTUFBTSxFQUFFO0VBQ25DbEIsUUFBUSxDQUNMbUIsT0FBTyxDQUFDSCxPQUFP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