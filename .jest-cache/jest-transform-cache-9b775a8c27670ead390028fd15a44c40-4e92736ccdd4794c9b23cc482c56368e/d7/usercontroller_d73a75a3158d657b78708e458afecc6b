2049a703d3864afe96e77d6b79079182
const User = require('../models/user.model');
const Apartment = require('../models/apartment.model');
const bcrypt = require('bcryptjs');

// @desc    Get user profile
// @route   GET /api/users/profile
// @access  Private
const getProfile = async (req, res, next) => {
  try {
    const user = await User.findById(req.user._id).select('-password');
    res.json(user);
  } catch (error) {
    next(error);
  }
};

// @desc    Update user profile
// @route   PUT /api/users/profile
// @access  Private
const updateProfile = async (req, res, next) => {
  try {
    const {
      name,
      email,
      phone,
      bio,
      profileImage,
      password
    } = req.body;

    // Build update object
    const updateFields = {};
    if (name) updateFields.name = name;
    if (email) updateFields.email = email;
    if (phone) updateFields.phone = phone;
    if (bio) updateFields.bio = bio;
    if (profileImage) updateFields.profileImage = profileImage;
    if (password) {
      const salt = await bcrypt.genSalt(10);
      updateFields.password = await bcrypt.hash(password, salt);
    }
    const user = await User.findByIdAndUpdate(req.user._id, updateFields, {
      new: true,
      runValidators: true
    }).select('-password');
    res.json(user);
  } catch (error) {
    next(error);
  }
};

// @desc    Delete user profile
// @route   DELETE /api/users/profile
// @access  Private
const deleteProfile = async (req, res, next) => {
  try {
    // Delete user's apartments if they are the owner
    await Apartment.deleteMany({
      owner: req.user._id
    });

    // Delete the user
    await User.findByIdAndDelete(req.user._id);
    res.json({
      message: 'User profile deleted successfully'
    });
  } catch (error) {
    next(error);
  }
};

// @desc    Update user preferences
// @route   PUT /api/users/preferences
// @access  Private
const updatePreferences = async (req, res, next) => {
  try {
    const user = await User.findByIdAndUpdate(req.user._id, {
      preferences: req.body
    }, {
      new: true,
      runValidators: true
    }).select('-password');
    res.json(user);
  } catch (error) {
    next(error);
  }
};

// @desc    Get saved searches
// @route   GET /api/users/searches
// @access  Private
const getSavedSearches = async (req, res, next) => {
  try {
    const user = await User.findById(req.user._id).select('savedSearches');
    res.json(user.savedSearches);
  } catch (error) {
    next(error);
  }
};

// @desc    Save search
// @route   POST /api/users/searches
// @access  Private
const saveSearch = async (req, res, next) => {
  try {
    const user = await User.findByIdAndUpdate(req.user._id, {
      $push: {
        savedSearches: req.body
      }
    }, {
      new: true,
      runValidators: true
    }).select('savedSearches');
    res.json(user.savedSearches);
  } catch (error) {
    next(error);
  }
};

// @desc    Delete saved search
// @route   DELETE /api/users/searches/:id
// @access  Private
const deleteSavedSearch = async (req, res, next) => {
  try {
    const user = await User.findByIdAndUpdate(req.user._id, {
      $pull: {
        savedSearches: {
          _id: req.params.id
        }
      }
    }, {
      new: true
    }).select('savedSearches');
    res.json(user.savedSearches);
  } catch (error) {
    next(error);
  }
};

// @desc    Get favorite apartments
// @route   GET /api/users/favorites
// @access  Private
const getFavoriteApartments = async (req, res, next) => {
  try {
    const user = await User.findById(req.user._id).populate({
      path: 'apartmentNotes.apartment',
      select: 'title price location bedrooms bathrooms area amenities images'
    });
    res.json(user.apartmentNotes);
  } catch (error) {
    next(error);
  }
};

// @desc    Get apartment notes
// @route   GET /api/users/apartments/:id/notes
// @access  Private
const getApartmentNotes = async (req, res, next) => {
  try {
    const user = await User.findById(req.user._id);
    const apartmentNotes = user.apartmentNotes.find(note => note.apartment.toString() === req.params.id);
    if (!apartmentNotes) {
      return res.json({
        notes: []
      });
    }
    res.json(apartmentNotes.notes);
  } catch (error) {
    next(error);
  }
};

// @desc    Add apartment note
// @route   POST /api/users/apartments/:id/notes
// @access  Private
const addApartmentNote = async (req, res, next) => {
  try {
    const apartment = await Apartment.findById(req.params.id);
    if (!apartment) {
      return res.status(404).json({
        error: 'Apartment not found'
      });
    }
    const user = await User.findById(req.user._id);
    const apartmentNotes = user.apartmentNotes.find(note => note.apartment.toString() === req.params.id);
    if (apartmentNotes) {
      apartmentNotes.notes.push({
        content: req.body.content
      });
    } else {
      user.apartmentNotes.push({
        apartment: req.params.id,
        notes: [{
          content: req.body.content
        }]
      });
    }
    await user.save();
    res.json(user.apartmentNotes);
  } catch (error) {
    next(error);
  }
};

// @desc    Update apartment note
// @route   PUT /api/users/apartments/:id/notes/:noteId
// @access  Private
const updateApartmentNote = async (req, res, next) => {
  try {
    const user = await User.findById(req.user._id);
    const apartmentNotes = user.apartmentNotes.find(note => note.apartment.toString() === req.params.id);
    if (!apartmentNotes) {
      return res.status(404).json({
        error: 'Apartment notes not found'
      });
    }
    const note = apartmentNotes.notes.id(req.params.noteId);
    if (!note) {
      return res.status(404).json({
        error: 'Note not found'
      });
    }
    note.content = req.body.content;
    note.updatedAt = Date.now();
    await user.save();
    res.json(apartmentNotes.notes);
  } catch (error) {
    next(error);
  }
};

// @desc    Delete apartment note
// @route   DELETE /api/users/apartments/:id/notes/:noteId
// @access  Private
const deleteApartmentNote = async (req, res, next) => {
  try {
    const user = await User.findById(req.user._id);
    const apartmentNotes = user.apartmentNotes.find(note => note.apartment.toString() === req.params.id);
    if (!apartmentNotes) {
      return res.status(404).json({
        error: 'Apartment notes not found'
      });
    }
    apartmentNotes.notes = apartmentNotes.notes.filter(note => note._id.toString() !== req.params.noteId);
    await user.save();
    res.json(apartmentNotes.notes);
  } catch (error) {
    next(error);
  }
};

// IMPORTANT: Handles user profile, update, and deletion logic
// TODO: Add user role management endpoints if needed in the future

module.exports = {
  getProfile,
  updateProfile,
  deleteProfile,
  updatePreferences,
  getSavedSearches,
  saveSearch,
  deleteSavedSearch,
  getFavoriteApartments,
  getApartmentNotes,
  addApartmentNote,
  updateApartmentNote,
  deleteApartmentNote
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsIkFwYXJ0bWVudCIsImJjcnlwdCIsImdldFByb2ZpbGUiLCJyZXEiLCJyZXMiLCJuZXh0IiwidXNlciIsImZpbmRCeUlkIiwiX2lkIiwic2VsZWN0IiwianNvbiIsImVycm9yIiwidXBkYXRlUHJvZmlsZSIsIm5hbWUiLCJlbWFpbCIsInBob25lIiwiYmlvIiwicHJvZmlsZUltYWdlIiwicGFzc3dvcmQiLCJib2R5IiwidXBkYXRlRmllbGRzIiwic2FsdCIsImdlblNhbHQiLCJoYXNoIiwiZmluZEJ5SWRBbmRVcGRhdGUiLCJuZXciLCJydW5WYWxpZGF0b3JzIiwiZGVsZXRlUHJvZmlsZSIsImRlbGV0ZU1hbnkiLCJvd25lciIsImZpbmRCeUlkQW5kRGVsZXRlIiwibWVzc2FnZSIsInVwZGF0ZVByZWZlcmVuY2VzIiwicHJlZmVyZW5jZXMiLCJnZXRTYXZlZFNlYXJjaGVzIiwic2F2ZWRTZWFyY2hlcyIsInNhdmVTZWFyY2giLCIkcHVzaCIsImRlbGV0ZVNhdmVkU2VhcmNoIiwiJHB1bGwiLCJwYXJhbXMiLCJpZCIsImdldEZhdm9yaXRlQXBhcnRtZW50cyIsInBvcHVsYXRlIiwicGF0aCIsImFwYXJ0bWVudE5vdGVzIiwiZ2V0QXBhcnRtZW50Tm90ZXMiLCJmaW5kIiwibm90ZSIsImFwYXJ0bWVudCIsInRvU3RyaW5nIiwibm90ZXMiLCJhZGRBcGFydG1lbnROb3RlIiwic3RhdHVzIiwicHVzaCIsImNvbnRlbnQiLCJzYXZlIiwidXBkYXRlQXBhcnRtZW50Tm90ZSIsIm5vdGVJZCIsInVwZGF0ZWRBdCIsIkRhdGUiLCJub3ciLCJkZWxldGVBcGFydG1lbnROb3RlIiwiZmlsdGVyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInVzZXIuY29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKTtcbmNvbnN0IEFwYXJ0bWVudCA9IHJlcXVpcmUoJy4uL21vZGVscy9hcGFydG1lbnQubW9kZWwnKTtcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdGpzJyk7XG5cbi8vIEBkZXNjICAgIEdldCB1c2VyIHByb2ZpbGVcbi8vIEByb3V0ZSAgIEdFVCAvYXBpL3VzZXJzL3Byb2ZpbGVcbi8vIEBhY2Nlc3MgIFByaXZhdGVcbmNvbnN0IGdldFByb2ZpbGUgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZChyZXEudXNlci5faWQpLnNlbGVjdCgnLXBhc3N3b3JkJyk7XG4gICAgcmVzLmpzb24odXNlcik7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbmV4dChlcnJvcik7XG4gIH1cbn07XG5cbi8vIEBkZXNjICAgIFVwZGF0ZSB1c2VyIHByb2ZpbGVcbi8vIEByb3V0ZSAgIFBVVCAvYXBpL3VzZXJzL3Byb2ZpbGVcbi8vIEBhY2Nlc3MgIFByaXZhdGVcbmNvbnN0IHVwZGF0ZVByb2ZpbGUgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IG5hbWUsIGVtYWlsLCBwaG9uZSwgYmlvLCBwcm9maWxlSW1hZ2UsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcblxuICAgIC8vIEJ1aWxkIHVwZGF0ZSBvYmplY3RcbiAgICBjb25zdCB1cGRhdGVGaWVsZHMgPSB7fTtcbiAgICBpZiAobmFtZSkgdXBkYXRlRmllbGRzLm5hbWUgPSBuYW1lO1xuICAgIGlmIChlbWFpbCkgdXBkYXRlRmllbGRzLmVtYWlsID0gZW1haWw7XG4gICAgaWYgKHBob25lKSB1cGRhdGVGaWVsZHMucGhvbmUgPSBwaG9uZTtcbiAgICBpZiAoYmlvKSB1cGRhdGVGaWVsZHMuYmlvID0gYmlvO1xuICAgIGlmIChwcm9maWxlSW1hZ2UpIHVwZGF0ZUZpZWxkcy5wcm9maWxlSW1hZ2UgPSBwcm9maWxlSW1hZ2U7XG4gICAgaWYgKHBhc3N3b3JkKSB7XG4gICAgICBjb25zdCBzYWx0ID0gYXdhaXQgYmNyeXB0LmdlblNhbHQoMTApO1xuICAgICAgdXBkYXRlRmllbGRzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2gocGFzc3dvcmQsIHNhbHQpO1xuICAgIH1cblxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlkQW5kVXBkYXRlKHJlcS51c2VyLl9pZCwgdXBkYXRlRmllbGRzLCB7XG4gICAgICBuZXc6IHRydWUsXG4gICAgICBydW5WYWxpZGF0b3JzOiB0cnVlLFxuICAgIH0pLnNlbGVjdCgnLXBhc3N3b3JkJyk7XG5cbiAgICByZXMuanNvbih1c2VyKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBuZXh0KGVycm9yKTtcbiAgfVxufTtcblxuLy8gQGRlc2MgICAgRGVsZXRlIHVzZXIgcHJvZmlsZVxuLy8gQHJvdXRlICAgREVMRVRFIC9hcGkvdXNlcnMvcHJvZmlsZVxuLy8gQGFjY2VzcyAgUHJpdmF0ZVxuY29uc3QgZGVsZXRlUHJvZmlsZSA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIC8vIERlbGV0ZSB1c2VyJ3MgYXBhcnRtZW50cyBpZiB0aGV5IGFyZSB0aGUgb3duZXJcbiAgICBhd2FpdCBBcGFydG1lbnQuZGVsZXRlTWFueSh7IG93bmVyOiByZXEudXNlci5faWQgfSk7XG5cbiAgICAvLyBEZWxldGUgdGhlIHVzZXJcbiAgICBhd2FpdCBVc2VyLmZpbmRCeUlkQW5kRGVsZXRlKHJlcS51c2VyLl9pZCk7XG5cbiAgICByZXMuanNvbih7IG1lc3NhZ2U6ICdVc2VyIHByb2ZpbGUgZGVsZXRlZCBzdWNjZXNzZnVsbHknIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIG5leHQoZXJyb3IpO1xuICB9XG59O1xuXG4vLyBAZGVzYyAgICBVcGRhdGUgdXNlciBwcmVmZXJlbmNlc1xuLy8gQHJvdXRlICAgUFVUIC9hcGkvdXNlcnMvcHJlZmVyZW5jZXNcbi8vIEBhY2Nlc3MgIFByaXZhdGVcbmNvbnN0IHVwZGF0ZVByZWZlcmVuY2VzID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICByZXEudXNlci5faWQsXG4gICAgICB7IHByZWZlcmVuY2VzOiByZXEuYm9keSB9LFxuICAgICAgeyBuZXc6IHRydWUsIHJ1blZhbGlkYXRvcnM6IHRydWUgfVxuICAgICkuc2VsZWN0KCctcGFzc3dvcmQnKTtcblxuICAgIHJlcy5qc29uKHVzZXIpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIG5leHQoZXJyb3IpO1xuICB9XG59O1xuXG4vLyBAZGVzYyAgICBHZXQgc2F2ZWQgc2VhcmNoZXNcbi8vIEByb3V0ZSAgIEdFVCAvYXBpL3VzZXJzL3NlYXJjaGVzXG4vLyBAYWNjZXNzICBQcml2YXRlXG5jb25zdCBnZXRTYXZlZFNlYXJjaGVzID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQocmVxLnVzZXIuX2lkKS5zZWxlY3QoJ3NhdmVkU2VhcmNoZXMnKTtcbiAgICByZXMuanNvbih1c2VyLnNhdmVkU2VhcmNoZXMpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIG5leHQoZXJyb3IpO1xuICB9XG59O1xuXG4vLyBAZGVzYyAgICBTYXZlIHNlYXJjaFxuLy8gQHJvdXRlICAgUE9TVCAvYXBpL3VzZXJzL3NlYXJjaGVzXG4vLyBAYWNjZXNzICBQcml2YXRlXG5jb25zdCBzYXZlU2VhcmNoID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICByZXEudXNlci5faWQsXG4gICAgICB7ICRwdXNoOiB7IHNhdmVkU2VhcmNoZXM6IHJlcS5ib2R5IH0gfSxcbiAgICAgIHsgbmV3OiB0cnVlLCBydW5WYWxpZGF0b3JzOiB0cnVlIH1cbiAgICApLnNlbGVjdCgnc2F2ZWRTZWFyY2hlcycpO1xuXG4gICAgcmVzLmpzb24odXNlci5zYXZlZFNlYXJjaGVzKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBuZXh0KGVycm9yKTtcbiAgfVxufTtcblxuLy8gQGRlc2MgICAgRGVsZXRlIHNhdmVkIHNlYXJjaFxuLy8gQHJvdXRlICAgREVMRVRFIC9hcGkvdXNlcnMvc2VhcmNoZXMvOmlkXG4vLyBAYWNjZXNzICBQcml2YXRlXG5jb25zdCBkZWxldGVTYXZlZFNlYXJjaCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlkQW5kVXBkYXRlKFxuICAgICAgcmVxLnVzZXIuX2lkLFxuICAgICAgeyAkcHVsbDogeyBzYXZlZFNlYXJjaGVzOiB7IF9pZDogcmVxLnBhcmFtcy5pZCB9IH0gfSxcbiAgICAgIHsgbmV3OiB0cnVlIH1cbiAgICApLnNlbGVjdCgnc2F2ZWRTZWFyY2hlcycpO1xuXG4gICAgcmVzLmpzb24odXNlci5zYXZlZFNlYXJjaGVzKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBuZXh0KGVycm9yKTtcbiAgfVxufTtcblxuLy8gQGRlc2MgICAgR2V0IGZhdm9yaXRlIGFwYXJ0bWVudHNcbi8vIEByb3V0ZSAgIEdFVCAvYXBpL3VzZXJzL2Zhdm9yaXRlc1xuLy8gQGFjY2VzcyAgUHJpdmF0ZVxuY29uc3QgZ2V0RmF2b3JpdGVBcGFydG1lbnRzID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQocmVxLnVzZXIuX2lkKS5wb3B1bGF0ZSh7XG4gICAgICBwYXRoOiAnYXBhcnRtZW50Tm90ZXMuYXBhcnRtZW50JyxcbiAgICAgIHNlbGVjdDogJ3RpdGxlIHByaWNlIGxvY2F0aW9uIGJlZHJvb21zIGJhdGhyb29tcyBhcmVhIGFtZW5pdGllcyBpbWFnZXMnLFxuICAgIH0pO1xuXG4gICAgcmVzLmpzb24odXNlci5hcGFydG1lbnROb3Rlcyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbmV4dChlcnJvcik7XG4gIH1cbn07XG5cbi8vIEBkZXNjICAgIEdldCBhcGFydG1lbnQgbm90ZXNcbi8vIEByb3V0ZSAgIEdFVCAvYXBpL3VzZXJzL2FwYXJ0bWVudHMvOmlkL25vdGVzXG4vLyBAYWNjZXNzICBQcml2YXRlXG5jb25zdCBnZXRBcGFydG1lbnROb3RlcyA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlkKHJlcS51c2VyLl9pZCk7XG4gICAgY29uc3QgYXBhcnRtZW50Tm90ZXMgPSB1c2VyLmFwYXJ0bWVudE5vdGVzLmZpbmQoXG4gICAgICAobm90ZSkgPT4gbm90ZS5hcGFydG1lbnQudG9TdHJpbmcoKSA9PT0gcmVxLnBhcmFtcy5pZFxuICAgICk7XG5cbiAgICBpZiAoIWFwYXJ0bWVudE5vdGVzKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oeyBub3RlczogW10gfSk7XG4gICAgfVxuXG4gICAgcmVzLmpzb24oYXBhcnRtZW50Tm90ZXMubm90ZXMpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIG5leHQoZXJyb3IpO1xuICB9XG59O1xuXG4vLyBAZGVzYyAgICBBZGQgYXBhcnRtZW50IG5vdGVcbi8vIEByb3V0ZSAgIFBPU1QgL2FwaS91c2Vycy9hcGFydG1lbnRzLzppZC9ub3Rlc1xuLy8gQGFjY2VzcyAgUHJpdmF0ZVxuY29uc3QgYWRkQXBhcnRtZW50Tm90ZSA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGFwYXJ0bWVudCA9IGF3YWl0IEFwYXJ0bWVudC5maW5kQnlJZChyZXEucGFyYW1zLmlkKTtcbiAgICBpZiAoIWFwYXJ0bWVudCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdBcGFydG1lbnQgbm90IGZvdW5kJyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZChyZXEudXNlci5faWQpO1xuICAgIGNvbnN0IGFwYXJ0bWVudE5vdGVzID0gdXNlci5hcGFydG1lbnROb3Rlcy5maW5kKFxuICAgICAgKG5vdGUpID0+IG5vdGUuYXBhcnRtZW50LnRvU3RyaW5nKCkgPT09IHJlcS5wYXJhbXMuaWRcbiAgICApO1xuXG4gICAgaWYgKGFwYXJ0bWVudE5vdGVzKSB7XG4gICAgICBhcGFydG1lbnROb3Rlcy5ub3Rlcy5wdXNoKHsgY29udGVudDogcmVxLmJvZHkuY29udGVudCB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdXNlci5hcGFydG1lbnROb3Rlcy5wdXNoKHtcbiAgICAgICAgYXBhcnRtZW50OiByZXEucGFyYW1zLmlkLFxuICAgICAgICBub3RlczogW3sgY29udGVudDogcmVxLmJvZHkuY29udGVudCB9XSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGF3YWl0IHVzZXIuc2F2ZSgpO1xuICAgIHJlcy5qc29uKHVzZXIuYXBhcnRtZW50Tm90ZXMpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIG5leHQoZXJyb3IpO1xuICB9XG59O1xuXG4vLyBAZGVzYyAgICBVcGRhdGUgYXBhcnRtZW50IG5vdGVcbi8vIEByb3V0ZSAgIFBVVCAvYXBpL3VzZXJzL2FwYXJ0bWVudHMvOmlkL25vdGVzLzpub3RlSWRcbi8vIEBhY2Nlc3MgIFByaXZhdGVcbmNvbnN0IHVwZGF0ZUFwYXJ0bWVudE5vdGUgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZChyZXEudXNlci5faWQpO1xuICAgIGNvbnN0IGFwYXJ0bWVudE5vdGVzID0gdXNlci5hcGFydG1lbnROb3Rlcy5maW5kKFxuICAgICAgKG5vdGUpID0+IG5vdGUuYXBhcnRtZW50LnRvU3RyaW5nKCkgPT09IHJlcS5wYXJhbXMuaWRcbiAgICApO1xuXG4gICAgaWYgKCFhcGFydG1lbnROb3Rlcykge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdBcGFydG1lbnQgbm90ZXMgbm90IGZvdW5kJyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBub3RlID0gYXBhcnRtZW50Tm90ZXMubm90ZXMuaWQocmVxLnBhcmFtcy5ub3RlSWQpO1xuICAgIGlmICghbm90ZSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdOb3RlIG5vdCBmb3VuZCcgfSk7XG4gICAgfVxuXG4gICAgbm90ZS5jb250ZW50ID0gcmVxLmJvZHkuY29udGVudDtcbiAgICBub3RlLnVwZGF0ZWRBdCA9IERhdGUubm93KCk7XG5cbiAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICByZXMuanNvbihhcGFydG1lbnROb3Rlcy5ub3Rlcyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbmV4dChlcnJvcik7XG4gIH1cbn07XG5cbi8vIEBkZXNjICAgIERlbGV0ZSBhcGFydG1lbnQgbm90ZVxuLy8gQHJvdXRlICAgREVMRVRFIC9hcGkvdXNlcnMvYXBhcnRtZW50cy86aWQvbm90ZXMvOm5vdGVJZFxuLy8gQGFjY2VzcyAgUHJpdmF0ZVxuY29uc3QgZGVsZXRlQXBhcnRtZW50Tm90ZSA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlkKHJlcS51c2VyLl9pZCk7XG4gICAgY29uc3QgYXBhcnRtZW50Tm90ZXMgPSB1c2VyLmFwYXJ0bWVudE5vdGVzLmZpbmQoXG4gICAgICAobm90ZSkgPT4gbm90ZS5hcGFydG1lbnQudG9TdHJpbmcoKSA9PT0gcmVxLnBhcmFtcy5pZFxuICAgICk7XG5cbiAgICBpZiAoIWFwYXJ0bWVudE5vdGVzKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ0FwYXJ0bWVudCBub3RlcyBub3QgZm91bmQnIH0pO1xuICAgIH1cblxuICAgIGFwYXJ0bWVudE5vdGVzLm5vdGVzID0gYXBhcnRtZW50Tm90ZXMubm90ZXMuZmlsdGVyKFxuICAgICAgKG5vdGUpID0+IG5vdGUuX2lkLnRvU3RyaW5nKCkgIT09IHJlcS5wYXJhbXMubm90ZUlkXG4gICAgKTtcblxuICAgIGF3YWl0IHVzZXIuc2F2ZSgpO1xuICAgIHJlcy5qc29uKGFwYXJ0bWVudE5vdGVzLm5vdGVzKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBuZXh0KGVycm9yKTtcbiAgfVxufTtcblxuLy8gSU1QT1JUQU5UOiBIYW5kbGVzIHVzZXIgcHJvZmlsZSwgdXBkYXRlLCBhbmQgZGVsZXRpb24gbG9naWNcbi8vIFRPRE86IEFkZCB1c2VyIHJvbGUgbWFuYWdlbWVudCBlbmRwb2ludHMgaWYgbmVlZGVkIGluIHRoZSBmdXR1cmVcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGdldFByb2ZpbGUsXG4gIHVwZGF0ZVByb2ZpbGUsXG4gIGRlbGV0ZVByb2ZpbGUsXG4gIHVwZGF0ZVByZWZlcmVuY2VzLFxuICBnZXRTYXZlZFNlYXJjaGVzLFxuICBzYXZlU2VhcmNoLFxuICBkZWxldGVTYXZlZFNlYXJjaCxcbiAgZ2V0RmF2b3JpdGVBcGFydG1lbnRzLFxuICBnZXRBcGFydG1lbnROb3RlcyxcbiAgYWRkQXBhcnRtZW50Tm90ZSxcbiAgdXBkYXRlQXBhcnRtZW50Tm90ZSxcbiAgZGVsZXRlQXBhcnRtZW50Tm90ZSxcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLHNCQUFzQixDQUFDO0FBQzVDLE1BQU1DLFNBQVMsR0FBR0QsT0FBTyxDQUFDLDJCQUEyQixDQUFDO0FBQ3RELE1BQU1FLE1BQU0sR0FBR0YsT0FBTyxDQUFDLFVBQVUsQ0FBQzs7QUFFbEM7QUFDQTtBQUNBO0FBQ0EsTUFBTUcsVUFB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